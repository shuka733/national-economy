# ナショナルエコノミー — Webプロトタイプ

ボードゲーム「ナショナルエコノミー」のブラウザ動作プロトタイプです。  
4人固定のホットシートモードで9ラウンドをプレイできます。

## 起動方法

```bash
cd national-economy
npm install
npm run dev
```

ブラウザで http://localhost:5173/ を開いてください。

---

## ゲームルール概要

### セットアップ
| 項目 | 内容 |
|------|------|
| プレイヤー | 4人固定 |
| 初期ワーカー | 各2体 |
| 初期手札 | 各3枚（建物カード） |
| 初期所持金 | P1:$5 / P2:$6 / P3:$7 / P4:$8 |

### ラウンドの流れ（全9ラウンド）
1. **仕事フェイズ**: スタートプレイヤーから順にワーカーを職場に配置し、効果を即座に適用。全員のワーカーを使い切るまで繰り返す。
2. **給料日フェイズ**: ワーカー数 × 賃金を支払う。不足時は建物を売却（1VP=$1）。それでも不足なら未払い賃金カード（-3VP/枚）。
3. **精算フェイズ**: 手札上限（5枚、倉庫で+4）を超過した分を捨てる。

### 賃金テーブル
| ラウンド | 賃金/人 |
|---------|--------|
| R1-2 | $2 |
| R3-5 | $3 |
| R6-7 | $4 |
| R8-9 | $5 |

### お金の循環
- **家計**: プレイヤーの賃金が集まる場所。売却系職場の収入源。残高不足なら配置不可。
- **サプライ**: 建物売却時の代金はここから。無限。

### ラウンド追加公共職場
| R | 職場名 | 効果 | 複数配置 |
|---|-------|------|---------|
| 2 | 露店 | 手札1枚捨て→家計$6 | ∞ |
| 3 | 市場 | 手札2枚捨て→家計$12 | × |
| 4 | 高等学校 | ワーカー4人に | × |
| 5 | スーパーマーケット | 手札3枚捨て→家計$18 | ∞ |
| 6 | 大学 | ワーカー5人に | × |
| 7 | 百貨店 | 手札4枚捨て→家計$24 | × |
| 8 | 専門学校 | ワーカー+1（即使用可） | × |
| 9 | 万博 | 手札5枚捨て→家計$30 | ∞ |

### 勝利点（VP）計算
- 建設済み建物のVP合計
- 所持金: $1 = 1VP
- 未払い賃金: 1枚 = -3VP
- 特殊ボーナス（不動産屋、農協、労働組合、本社ビル、鉄道）

---

## 建物カード一覧

### コスト1
| カード名 | 枚数 | VP | タグ | 効果 |
|---------|------|-----|------|------|
| 農場 | 8 | 6 | ※農園 | 消費財を2枚引く |
| 焼畑 | 2 | 0 | ※農園 🔒 | 消費財を5枚引く。使用後消滅 |
| 珈琲店 | 2 | 8 | — | 家計から$5を得る |
| 設計事務所 | 4 | 8 | — | 山札5枚公開→1枚手札、残り捨て |

### コスト2
| カード名 | 枚数 | VP | タグ | 効果 |
|---------|------|-----|------|------|
| 工場 | 8 | 12 | ※工場 | 手札2枚捨て→4枚引く |
| 建設会社 | 4 | 10 | — | 建物を1つ作る（コスト-1） |
| 倉庫 | 3 | 10 | 🔒 | 手札上限+4 |
| 法律事務所 | 1 | 8 | 🔒 | 終了時、負債5枚まで免除 |
| 果樹園 | 3 | 10 | ※農園 | 手札4枚になるまで消費財を引く |
| 社宅 | 2 | 8 | 🔒 | ワーカー上限+1 |

### コスト3
| カード名 | 枚数 | VP | タグ | 効果 |
|---------|------|-----|------|------|
| 不動産屋 | 2 | 10 | 🔒 | 終了時、所有建物1つにつき+3VP |
| 開拓民 | 2 | 14 | — | 手札の※農園を1つ無料建設 |
| レストラン | 2 | 16 | — | 手札1枚捨て→家計$15 |
| 大農園 | 3 | 12 | ※農園 | 消費財を3枚引く |
| 農協 | 1 | 12 | 🔒 | 終了時、手札の消費財1枚につき+3VP |

### コスト4
| カード名 | 枚数 | VP | タグ | 効果 |
|---------|------|-----|------|------|
| ゼネコン | 3 | 18 | — | 建物1つ建設→カード2枚引く |
| 製鉄所 | 3 | 20 | ※工場 | カードを3枚引く |
| 邸宅 | 1 | 28 | 🔒 | 効果なし（VPのみ） |
| 化学工場 | 2 | 18 | ※工場 | カード2枚引く（手札0枚なら4枚） |
| 労働組合 | 1 | 0 | 🔒 | 終了時、ワーカー1人につき+6VP |

### コスト5
| カード名 | 枚数 | VP | タグ | 効果 |
|---------|------|-----|------|------|
| 自動車工場 | 3 | 24 | ※工場 | 手札3枚捨て→7枚引く |
| 本社ビル | 1 | 20 | 🔒 | 終了時、🔒マーク1つにつき+6VP |
| 二胡市建設 | 2 | 20 | — | 同コスト建物2つ同時建設（コスト1つ分） |
| 鉄道 | 1 | 18 | 🔒 | 終了時、※工場1つにつき+8VP |

---

## オンライン対戦（P2P）の遊び方

同じWi-Fi（LAN）内の別PCとオンライン対戦ができます。  
PeerJSを使ったP2P通信のため、専用サーバーは不要です。

### 前提条件
- 2台以上のPCが**同じWi-Fiネットワーク**に接続されていること
- ホストPC（開発サーバーを動かすPC）で `npm run dev` を実行済みであること

### 手順

#### ホスト側（ゲームを作成する人）
1. `npm run dev` を実行する
2. ターミナルに表示される **Network** のURL（例: `http://192.168.x.x:5173/`）を確認する
3. ブラウザで `http://localhost:5173/` を開く
4. 「🌐 オンライン対戦」→「🏠 ゲームを作成（ホスト）」を選択
5. プレイヤー人数を設定する（2〜4人）
6. 表示された **Peer ID** をゲストに共有する（チャット、LINE等）

#### ゲスト側（参加する人）
1. ブラウザでホストの **Network URL**（`http://192.168.x.x:5173/`）を開く
2. 「🌐 オンライン対戦」→「🔗 ゲームに参加」を選択
3. ホストから受け取った **Peer ID** を入力して「🔗 接続する」をクリック

#### ゲーム開始
1. ホスト側で全プレイヤーの接続を確認（「接続済み ✅」表示）
2. 「🚀 ゲーム開始！」をクリック
3. 各プレイヤーに番号（P1〜P4）とスタートプレイヤーが通知される

### トラブルシューティング
- **ゲストPCからアクセスできない**: Windows Defenderファイアウォールでポート（5173等）のプライベートネットワーク通信を許可してください
- **Peer ID接続に失敗する**: ブラウザのコンソールでエラーを確認し、ページをリロードして再試行してください

---

## 操作方法
1. **ワーカー配置**: 緑色にハイライトされた職場をクリック
2. **個人建物への配置**: 自分の場の建物をクリック
3. **カード捨て**: モーダルで捨てるカードを選択→確定ボタン
4. **建設**: 建設モードで手札のカードをクリック→コスト支払い
5. **給料日の売却**: 売却可能な建物をクリック→支払い確定

## 技術スタック
- React + TypeScript (Vite)
- BoardGame.io（状態管理・ターン制御）
- Tailwind CSS v4
